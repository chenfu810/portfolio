<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portfolio Pulse</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,600;9..144,700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css?v=20260208-18" />
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  </head>
  <body>
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>
    <div class="bg-grid"></div>

    <main class="app">
      <header class="topbar">
        <div>
          <p class="eyebrow">Portfolio Pulse</p>
          <h1>Track your portfolio at a glance.</h1>
        </div>
        <div class="topbar-actions">
          <div id="themeToggle" class="theme-toggle" role="group" aria-label="Theme">
            <button type="button" class="theme-pill active" data-theme="nocturne" aria-pressed="true">Nocturne</button>
            <button type="button" class="theme-pill" data-theme="ocean" aria-pressed="false">Ocean</button>
            <button type="button" class="theme-pill" data-theme="ember" aria-pressed="false">Ember</button>
          </div>
          <button id="refreshBtn" class="ghost-btn">Refresh</button>
        </div>
      </header>

      <section class="hero">
        <div class="hero-card">
          <p class="label">Total Value</p>
          <h2 id="totalValue">$0</h2>
          <p id="dailyChange" class="delta">+0.00% today</p>
        </div>
        <div class="hero-card highlight">
          <p class="label">Performance & Mix</p>
          <div class="performance-grid">
            <div class="performance-item">
              <p class="label">1W Return</p>
              <p id="perf1W" class="performance-value">—</p>
            </div>
            <div class="performance-item">
              <p class="label">1M Return</p>
              <p id="perf1M" class="performance-value">—</p>
            </div>
            <div class="performance-item">
              <p class="label">YTD Return</p>
              <p id="perfYTD" class="performance-value">—</p>
            </div>
            <div class="performance-item">
              <p class="label">Cash %</p>
              <p id="perfCashPct" class="performance-value">0.00%</p>
            </div>
            <div class="performance-item">
              <p class="label">Crypto %</p>
              <p id="perfCryptoPct" class="performance-value">0.00%</p>
            </div>
          </div>
        </div>
      </section>

      <section class="panel daily-panel">
        <div class="panel-header">
          <div>
            <h3>Daily Gain / Loss</h3>
            <p id="dailyTotalPLMeta" class="subtle">Today</p>
          </div>
          <div class="daily-header-actions">
            <p id="dailyTotalPL" class="daily-total">$0</p>
            <button
              id="dailyHistoryToggle"
              class="daily-history-toggle"
              type="button"
              aria-expanded="false"
              aria-controls="dailyHistoryWrap"
            >
              View Daily History
            </button>
          </div>
        </div>
        <div id="dailyHistoryWrap" class="daily-history-wrap" hidden>
          <div id="dailyCalendarMonths" class="daily-calendar-months"></div>
          <div id="dailyCalendarEmpty" class="empty" style="display: none">
            Daily changes are saved automatically in this browser (from Feb 2026).
          </div>
        </div>
      </section>

      <section class="panel benchmark-panel">
        <div class="panel-header">
          <h3>Portfolio vs Benchmarks</h3>
          <p id="benchmarkMeta" class="subtle">Loading benchmark context...</p>
        </div>
        <div class="benchmark-curve-wrap">
          <canvas id="benchmarkCurve"></canvas>
          <div id="benchmarkCurveEmpty" class="empty" style="display: none">
            Need more portfolio history to draw the curve. Keep this page running daily.
          </div>
        </div>
        <div class="table-wrap">
          <table class="benchmark-table">
            <thead>
              <tr>
                <th>Instrument</th>
                <th>1D</th>
                <th>1W</th>
                <th>1M</th>
                <th>YTD</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">Portfolio</th>
                <td id="benchmarkPortfolio1D">—</td>
                <td id="benchmarkPortfolio1W">—</td>
                <td id="benchmarkPortfolio1M">—</td>
                <td id="benchmarkPortfolioYTD">—</td>
              </tr>
              <tr>
                <th scope="row">SPY</th>
                <td id="benchmarkSPY1D">—</td>
                <td id="benchmarkSPY1W">—</td>
                <td id="benchmarkSPY1M">—</td>
                <td id="benchmarkSPYYTD">—</td>
              </tr>
              <tr>
                <th scope="row">QQQ</th>
                <td id="benchmarkQQQ1D">—</td>
                <td id="benchmarkQQQ1W">—</td>
                <td id="benchmarkQQQ1M">—</td>
                <td id="benchmarkQQQYTD">—</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h3>Expert Advice</h3>
          <div class="advice-controls">
            <select id="adviceSource" class="sort-select">
              <option value="built_in">Portfolio Pulse Analyst</option>
              <option value="chatgpt">ChatGPT Prompt</option>
              <option value="claude">Claude Prompt</option>
              <option value="gemini">Gemini Prompt</option>
              <option value="perplexity">Perplexity Prompt</option>
            </select>
            <select id="adviceMode" class="sort-select">
              <option value="balanced">Balanced</option>
              <option value="defensive">Defensive</option>
              <option value="growth">Growth</option>
              <option value="active">Active Trading</option>
            </select>
            <button id="adviceRefresh" class="ghost-btn small">Refresh Advice</button>
          </div>
        </div>
        <p id="adviceMeta" class="subtle">Advice based on your holdings and loaded market news.</p>
        <ul id="adviceList" class="advice-list"></ul>
        <div id="advicePromptWrap" class="advice-prompt-wrap" style="display: none">
          <div class="advice-prompt-header">
            <a id="adviceExternalLink" href="#" target="_blank" rel="noopener noreferrer">Open AI Tool</a>
            <button id="copyAdvicePrompt" class="ghost-btn small">Copy Prompt</button>
          </div>
          <textarea id="advicePrompt" class="advice-prompt" readonly></textarea>
        </div>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h3>Market News Digest</h3>
          <div class="advice-controls">
            <select id="newsSource" class="sort-select">
              <option value="all">All Sources</option>
              <option value="cnbc">CNBC</option>
              <option value="yahoo">Yahoo Finance</option>
              <option value="reuters">Reuters</option>
            </select>
            <select id="newsFocus" class="sort-select">
              <option value="all">All Market</option>
              <option value="macro">Macro / Fed</option>
              <option value="earnings">Earnings</option>
              <option value="tech">Technology</option>
            </select>
            <button id="newsRefresh" class="ghost-btn small">Refresh News</button>
          </div>
        </div>
        <p id="newsMeta" class="subtle">Loading latest headlines...</p>
        <div id="newsList" class="news-list"></div>
      </section>

      <section class="panel">
        <div class="panel-header">
          <div>
            <h3>Allocation Map</h3>
          </div>
          <div id="treemapBreadcrumb" class="breadcrumb">All Stocks</div>
        </div>
        <div class="allocation-exposure">
          <p id="allocationCryptoLine" class="subtle allocation-line allocation-line-crypto">
            Digital asset exposure: 0.00% of total portfolio value.
          </p>
          <p id="allocationCashLine" class="subtle allocation-line allocation-line-cash">
            Cash allocation: 0.00% of total portfolio value.
          </p>
        </div>
        <div id="treemap" class="treemap"></div>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h3>Portfolio Value Over Time</h3>
          <p class="subtle">Uses a separate history tab if provided.</p>
        </div>
        <div id="historyEmpty" class="empty">
          Add a history tab with columns: <span class="mono">date</span>,
          <span class="mono">total value</span>. Then click <span class="mono">Refresh</span>.
        </div>
        <canvas id="historyChart"></canvas>
      </section>

      <section class="panel table-panel">
        <div class="panel-header">
          <h3>Holdings</h3>
        </div>
        <div class="table-wrap">
          <table>
            <thead id="holdingsHead">
              <tr>
                <th>Ticker</th>
                <th>Shares</th>
                <th>Price</th>
                <th>
                  <button type="button" class="table-sort-btn" data-sort-key="dailyPct">
                    Daily %
                    <span class="sort-arrow" aria-hidden="true">↕</span>
                  </button>
                </th>
                <th>
                  <button type="button" class="table-sort-btn" data-sort-key="dailyValue">
                    Daily Value Change
                    <span class="sort-arrow" aria-hidden="true">↕</span>
                  </button>
                </th>
                <th>
                  <button type="button" class="table-sort-btn" data-sort-key="value">
                    Value
                    <span class="sort-arrow" aria-hidden="true">↕</span>
                  </button>
                </th>
              </tr>
            </thead>
            <tbody id="holdingsTable"></tbody>
          </table>
        </div>
      </section>

      <section class="panel footer">
        <p>
          Data source:
          <span id="sourceLabel" class="mono">Sample data</span>
        </p>
      </section>
    </main>

    <script src="app.js?v=20260208-24"></script>
  </body>
</html>
